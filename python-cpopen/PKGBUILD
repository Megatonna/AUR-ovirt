# Contributor: Andrii Sokolenko
# Based by Ovirt python-cpopen.spec
pkgbase=cpopen-git
pkgname=(python2-cpopen python-cpopen)
pkgver=1.5.git826b5ef
pkgrel=1
pkgdesc="A C reimplementation of the tricky bits of Python's Popen"
arch=('i686' 'x86_64')
url="http://www.ovirt.org/"
license=('GPLv2+')
groups=()
conflicts=()
replaces=()
backup=()
options=(!emptydirs)
install=()
checkdepends=('python-nose')
source=('git+https://gerrit.ovirt.org/p/cpopen.git')
sha256sums=('SKIP')

prepare() {
  mkdir -p build-{python2,python}
}

check() {
  cd ${srcdir}/${pkgbase%%-git}
#  nosetests2 tests/tests.py
}

build() {
  cd ${srcdir}/${pkgbase%%-git}
  CPOPEN_VERSION=${pkgver%%.git} python2 setup.py build
  CPOPEN_VERSION=${pkgver%%.git} python3 setup.py build
}

package_python2-cpopen() {
  depends=('python2')
  cd ${srcdir}/${pkgbase%%-git}
  CPOPEN_VERSION=${pkgver%%.git} python2 setup.py install --root=${pkgdir} --prefix=/usr
}

package_python-cpopen() {
  depends=('python3')
  cd ${srcdir}/${pkgbase%%-git}
  CPOPEN_VERSION=${pkgver%%.git} python3 setup.py install --root=${pkgdir} --prefix=/usr
}
# vim:set ts=2 sw=2 et:
